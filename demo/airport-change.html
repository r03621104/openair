<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>全球機場航班變化</title>
  <link rel="stylesheet" href="https://yui-s.yahooapis.com/pure/0.5.0/pure-min.css">
  <link rel="stylesheet" href="https://rawgit.com/tpreusse/radar-chart-d3/master/src/radar-chart.css">
  <!-- zoom -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>

  <script src="https://d3js.org/d3.v4.js"></script>
  <script src="https://rawgit.com/tpreusse/radar-chart-d3/master/src/radar-chart.js"></script>
  <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
  <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js"></script>

  <!-- Color Scale -->
  <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

  <style>
    img {
      max-width: 100%;
      max-height: 100%;
    }

    .bg-dark {
      background-color: #0081A7 !important;
    }

    .sb-sidenav-dark {
      background-color: #00AFB9;
      color: #FDFCDC;
    }

    .sb-sidenav-dark .sb-sidenav-footer {
      background-color: #0081A7;
    }

    .mapsvg {
      background-color: #d6e9fd;
      font-family: Verdana, sans-serif;
    }
  </style>
  <link href="../css/styles.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/js/all.min.js" crossorigin="anonymous"></script>

  <style>
    body {
      padding: 50px;
    }

  </style>

</head>

<body class="sb-nav-fixed">

  <!-- 上面那一行標頭-->
  <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
    <a class="navbar-brand" href="../index.html"><i class="fas fa-head-side-mask"></i> 小心疫翼</a>
    <button class="btn btn-link btn-sm order-1 order-lg-0" id="sidebarToggle" href="#"><i class="fas fa-bars"></i></button>
  </nav>

  <div id="layoutSidenav">

    <!-- 左邊邊 -->
    <div id="layoutSidenav_nav">
      <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
        <div class="sb-sidenav-menu">
          <div class="nav">
            <div class="sb-sidenav-menu-heading">首頁</div>
            <a class="nav-link" href="../index.html">
              <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt"></i></div>
              總覽
            </a>
            <div class="sb-sidenav-menu-heading">分析結果</div>
            <a class="nav-link active" href="./airport-change.html">
              <div class="sb-nav-link-icon"><i class="fas fa-map-marker-alt"></i></div>
              各國機場航班變化
            </a>
            <a class="nav-link" href="./airport-cluster.html">
              <div class="sb-nav-link-icon"><i class="fas fa-globe-americas"></i></div>
              集群機場生態
            </a>
            <a class="nav-link" href="./before-after.html">
              <div class="sb-nav-link-icon"><i class="fas fa-plane"></i></div>
              疫情前後差異
            </a>
          </div>
        </div>
        <div class="sb-sidenav-footer">
          <div class="small"></div>
          <i class="fas fa-users"></i> BDSE15-4
        </div>
      </nav>
    </div>

    <!-- 主要頁面內容 -->
    <div id="layoutSidenav_content">
      <main>

        <div class="container-fluid">
          <div class="row">
          <h1 class="mt-4"><i class="fas fa-globe-asia"></i> 全球各國航班數兩年度變化</h1>


            <!-- Choropleth -->
            <!-- Create an element where the map will take place -->
            <svg id="my_dataviz" width="1450" height="700"></svg>

            <script>

              // The svg
              var svg = d3.select("svg").attr("class", "mapsvg"),
                width = svg.attr("width"),
                height = svg.attr("height");

              // Map and projection
              var path = d3.geoPath();
              var projection = d3.geoNaturalEarth()
                .scale(300)
                .center([-55, 35])
                .translate([width / 3.5, height / 3]);

              var g = svg.append("g");

              // Data 
              var data = d3.map();
              // Color scale
              var colorScale = d3.scaleThreshold()  // 會按照給定的門檻去做比例尺換算
                .domain([-2, -0.5, -0.25, 0, 0.5, 5])
                .range(["#2b9348", "#55a630", "#80b918", "#aacc00", "#dddf00", "#eeef20", "#ffff3f"])// 分成7組，schemePuRd(d3.schemeGreens[7])["#00441b", "#006d2c", "#238b45", "#41ab5d", "#74c476", "#a1d99b", "#c7e9c0"]


              // Add legend
              svg.append("g")
                .attr("class", "legendQuant")
                .attr("transform", "translate(40," + (height - 200) + ")")
              
              // var rect = svg.append("rect")
              //   .attr("width", "200px")
              //   .attr("height", "300px")
              //   .attr("fill", "red")
              //   .attr("transform", "translate(0,100)")


              var legend = d3.legendColor()
                .labelFormat(d3.format(".2f"))
                .labels(d3.legendHelpers.thresholdLabels)
                .scale(colorScale)


              svg.select(".legendQuant")
                .call(legend);

              // Load external data and boot
              d3.queue()
                .defer(d3.json, "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson")
                .defer(d3.csv, "./data/ratio.csv", function (d) { data.set(d.code, d.ratio); }) // csv的d.code欄可以對照到geojson裡的id。d3.map.set(key,value)設定某個key的值，但置換後並不會影響到原本的值
                .await(ready);


              console.log(data)

              function ready(error, topo) {
                console.log(topo)

                // 動畫
                let mouseOver = function (d) {
                  d3.selectAll(".Country")
                    .style("opacity", 0.8)
                  d3.select(this) // this指向各國家
                    .transition()
                    .duration(100)
                    .style("opacity", 1)
                    .style("stroke", "black")
                    .style("stroke-width", 2.5)
                }

                let mouseLeave = function (d) {
                  d3.selectAll(".Country")
                    .style("opacity", 0.8)
                  d3.select(this)
                    .transition()
                    .duration(100)
                    .style("stroke", "white")  // 透明"transparent"
                    .style("stroke-width", 1)
                }

                // Draw the map
                g.selectAll("path")
                  .data(topo.features) // geojson
                  .enter()
                  .append("path")
                  // Draw each country
                  .attr("d", d3.geoPath()
                    .projection(projection)
                  )
                  // Set the color of each country
                  .attr("fill", function (d) {
                    d.total = data.get(d.id) || 0;  // or=>||，取geojson的id欄的值(d3.map.get() returns the value for the specified key string.)，剛好對照到csv檔的d.code值
                    return colorScale(d.total);
                  })
                  .style("stroke", "white") // 原本樣式
                  .attr("class", "Country")
                  .style("opacity", .5) // 原本樣式
                  .on("mouseover", mouseOver)
                  .on("mouseleave", mouseLeave)

              }

              // zoom
              var zoom = d3.behavior.zoom()
                .on("zoom", function () {
                  g.attr("transform", "translate(" +
                    d3.event.translate.join(",") + ")scale(" + d3.event.scale + ")");
                  g.selectAll("path")
                    .attr("d", path.projection(projection));
                });

              svg.call(zoom)

            </script>



          </div>
        </div>

        <div class="container-fluid">
          <h1 class="mt-4"><i class="fas fa-chart-line"></i> 各國航班數兩年度比較</h1>


          <div class="container-child">
            <div id="my_dataviz1"></div>
            <script>
              // set the dimensions and margins of the graph
              var margin = { top: 10, right: 100, bottom: 30, left: 100 },
                width = 710 - margin.left - margin.right,
                height = 400 - margin.top - margin.bottom;

              // append the svg object to the body of the page
              var svg = d3.select("#my_dataviz1")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom + 100)
                .append("g")
                .attr("transform",
                  "translate(" + margin.left + "," + margin.bottom + ")");

              //Read the data
              d3.csv("./data/TW_connected_scatter.csv", function (data) {

                // List of groups (here I have one group per column)
                var allGroup = ["Taiwan_2019", "Taiwan_2020"]

                // Reformat the data: we need an array of arrays of {x, y} tuples
                var dataReady = allGroup.map(function (grpName) { // .map allows to do something for each element of the list
                  return {
                    name: grpName,
                    values: data.map(function (d) {
                      return { time: d.time, value: +d[grpName] };
                    })
                  };
                });
                // I strongly advise to have a look to dataReady with
                console.log(dataReady)

                // A color scale: one color for each group
                var myColor = d3.scaleOrdinal()
                  .domain(allGroup)
                  .range(d3.schemeCategory10);

                // Add X axis --> it is a date format
                var tickLabels = ['0', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                var x = d3.scaleLinear()
                  .domain([0, 12])
                  .range([0, width])
                svg.append("g")
                  .attr("transform", "translate(0," + height + ")")
                  .style("font-size", "15px")
                  .call(d3.axisBottom(x).tickFormat(function (d, i) { return tickLabels[i] }));

                // Add Y axis
                var y = d3.scaleLinear()
                  .domain([9000, 40000])
                  .range([height, 0]);
                svg.append("g")
                  .style("font-size", "15px")
                  .call(d3.axisLeft(y));

                // Add the lines
                var line = d3.line()
                  .x(function (d) { return x(+d.time) })
                  .y(function (d) { return y(+d.value) })
                svg.selectAll("myLines")
                  .data(dataReady)
                  .enter()
                  .append("path")
                  .attr("class", function (d) { return d.name })
                  .attr("d", function (d) { return line(d.values) })
                  .attr("stroke", function (d) { return myColor(d.name) })
                  .style("stroke-width", 4)
                  .style("fill", "none")
                // .style("opacity", 0)

                // Add the points
                svg
                  // First we need to enter in a group
                  .selectAll("myDots")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .style("fill", function (d) { return myColor(d.name) })
                  .attr("class", function (d) { return d.name })
                  // .style("opacity", 0)
                  // Second we need to enter in the 'values' part of this group
                  .selectAll("myPoints")
                  .data(function (d) { return d.values })
                  .enter()
                  .append("circle")
                  .attr("cx", function (d) { return x(d.time) })
                  .attr("cy", function (d) { return y(d.value) })
                  .attr("r", 5)
                  .attr("stroke", "white")

                // Add a label at the end of each line
                svg
                  .selectAll("myLabels")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr("class", function (d) { return d.name })
                  .datum(function (d) { return { name: d.name, value: d.values[d.values.length - 1] }; }) // keep only the last value of each time series
                  .attr("transform", function (d) { return "translate(" + x(d.value.time) + "," + y(d.value.value) + ")"; }) // Put the text at the position of the last point
                  .attr("x", 12) // shift the text a bit more right
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                // .style("opacity", 0)

                // Add a legend (interactive)
                svg
                  .selectAll("myLegend")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr('x', function (d, i) { return 30 + i * 160 })
                  .attr('y', 430)
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                  .on("click", function (d) {
                    // is the element currently visible ?
                    currentOpacity = d3.selectAll("." + d.name).style("opacity")
                    // Change the opacity: from 0 to 1 or from 1 to 0
                    d3.selectAll("." + d.name).transition().style("opacity", currentOpacity == 1 ? 0 : 1)

                  })
              })
              var myimage = svg.append('image')
                .attr('xlink:href', '../img/TW.png')
                .attr('width', 70)

              myimage.attr('x', 40)

            </script>
          </div>

          <div class="container-child">
            <div id="my_dataviz2"></div>
            <script>

              // set the dimensions and margins of the graph
              var margin = { top: 10, right: 100, bottom: 30, left: 100 },
                width = 710 - margin.left - margin.right,
                height = 400 - margin.top - margin.bottom;

              // append the svg object to the body of the page
              var svg1 = d3.select("#my_dataviz2")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom + 100)
                .append("g")
                .attr("transform",
                  "translate(" + margin.left + "," + margin.bottom + ")");

              //Read the data
              d3.csv("./data/JP_connected_scatter.csv", function (data) {

                // List of groups (here I have one group per column)
                var allGroup = ["Japan_2019", "Japan_2020"]

                // Reformat the data: we need an array of arrays of {x, y} tuples
                var dataReady = allGroup.map(function (grpName) { // .map allows to do something for each element of the list
                  return {
                    name: grpName,
                    values: data.map(function (d) {
                      return { time: d.time, value: +d[grpName] };
                    })
                  };
                });
                // I strongly advise to have a look to dataReady with
                console.log(dataReady)

                // A color scale: one color for each group
                var myColor = d3.scaleOrdinal()
                  .domain(allGroup)
                  .range(d3.schemeCategory10);

                // Add X axis --> it is a date format
                var tickLabels = ['0', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                var x = d3.scaleLinear()
                  .domain([0, 12])
                  .range([0, width])
                svg1.append("g")
                  .style("font-size", "15px")
                  .attr("transform", "translate(0," + height + ")")
                  .call(d3.axisBottom(x).tickFormat(function (d, i) { return tickLabels[i] }));

                // Add Y axis
                var y = d3.scaleLinear()
                  .domain([13000, 75000])
                  .range([height, 0]);
                svg1.append("g")
                  .style("font-size", "15px")
                  .call(d3.axisLeft(y));

                // Add the lines
                var line = d3.line()
                  .x(function (d) { return x(+d.time) })
                  .y(function (d) { return y(+d.value) })
                svg1.selectAll("myLines")
                  .data(dataReady)
                  .enter()
                  .append("path")
                  .attr("class", function (d) { return d.name })
                  .attr("d", function (d) { return line(d.values) })
                  .attr("stroke", function (d) { return myColor(d.name) })
                  .style("stroke-width", 4)
                  .style("fill", "none")
                // .style("opacity", 0)

                // Add the points
                svg1
                  // First we need to enter in a group
                  .selectAll("myDots")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .style("fill", function (d) { return myColor(d.name) })
                  .attr("class", function (d) { return d.name })
                  // .style("opacity", 0)
                  // Second we need to enter in the 'values' part of this group
                  .selectAll("myPoints")
                  .data(function (d) { return d.values })
                  .enter()
                  .append("circle")
                  .attr("cx", function (d) { return x(d.time) })
                  .attr("cy", function (d) { return y(d.value) })
                  .attr("r", 5)
                  .attr("stroke", "white")

                // Add a label at the end of each line
                svg1
                  .selectAll("myLabels")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr("class", function (d) { return d.name })
                  .datum(function (d) { return { name: d.name, value: d.values[d.values.length - 1] }; }) // keep only the last value of each time series
                  .attr("transform", function (d) { return "translate(" + x(d.value.time) + "," + y(d.value.value) + ")"; }) // Put the text at the position of the last point
                  .attr("x", 12) // shift the text a bit more right
                  .attr('y', function (d, i) { return i * 9 })
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                // .style("opacity", 0)

                // Add a legend (interactive)
                svg1
                  .selectAll("myLegend")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr('x', function (d, i) { return 30 + i * 155 })
                  .attr('y', 430)
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                  .on("click", function (d) {
                    // is the element currently visible ?
                    currentOpacity = d3.selectAll("." + d.name).style("opacity")
                    // Change the opacity: from 0 to 1 or from 1 to 0
                    d3.selectAll("." + d.name).transition().style("opacity", currentOpacity == 1 ? 0 : 1)

                  })
              })
              var myimage = svg1.append('image')
                .attr('xlink:href', '../img/JP.png')
                .attr('width', 70)
                .attr("style", "outline: thin solid black;")

              myimage.attr('x', 40)

            </script>
          </div>

          <div class="container-child">
            <div id="my_dataviz3"></div>
            <script>

              // set the dimensions and margins of the graph
              var margin = { top: 10, right: 100, bottom: 30, left: 100 },
                width = 610 - margin.left - margin.right,
                height = 400 - margin.top - margin.bottom;

              // append the svg object to the body of the page
              var svg3 = d3.select("#my_dataviz3")
                .append("svg")
                .attr("width", width + margin.left + margin.right + 100)
                .attr("height", height + margin.top + margin.bottom + 100)
                .append("g")
                .attr("transform",
                  "translate(" + margin.left + "," + margin.bottom + ")");

              //Read the data
              d3.csv("./data/GB_connected_scatter.csv", function (data) {

                // List of groups (here I have one group per column)
                var allGroup = ["UK_2019", "UK_2020"]

                // Reformat the data: we need an array of arrays of {x, y} tuples
                var dataReady = allGroup.map(function (grpName) { // .map allows to do something for each element of the list
                  return {
                    name: grpName,
                    values: data.map(function (d) {
                      return { time: d.time, value: +d[grpName] };
                    })
                  };
                });
                // I strongly advise to have a look to dataReady with
                console.log(dataReady)

                // A color scale: one color for each group
                var myColor = d3.scaleOrdinal()
                  .domain(allGroup)
                  .range(d3.schemeCategory10);

                // Add X axis --> it is a date format
                var tickLabels = ['0', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                var x = d3.scaleLinear()
                  .domain([0, 12])
                  .range([0, width])
                svg3.append("g")
                  .attr("transform", "translate(0," + height + ")")
                  .style("font-size", "15px")
                  .call(d3.axisBottom(x).tickFormat(function (d, i) { return tickLabels[i] }));

                // Add Y axis
                var y = d3.scaleLinear()
                  .domain([10000, 200000])
                  .range([height, 0]);
                svg3.append("g")
                  .style("font-size", "15px")
                  .call(d3.axisLeft(y));

                // Add the lines
                var line = d3.line()
                  .x(function (d) { return x(+d.time) })
                  .y(function (d) { return y(+d.value) })
                svg3.selectAll("myLines")
                  .data(dataReady)
                  .enter()
                  .append("path")
                  .attr("class", function (d) { return d.name })
                  .attr("d", function (d) { return line(d.values) })
                  .attr("stroke", function (d) { return myColor(d.name) })
                  .style("stroke-width", 4)
                  .style("fill", "none")
                // .style("opacity", 0)

                // Add the points
                svg3
                  // First we need to enter in a group
                  .selectAll("myDots")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .style("fill", function (d) { return myColor(d.name) })
                  .attr("class", function (d) { return d.name })
                  // .style("opacity", 0)
                  // Second we need to enter in the 'values' part of this group
                  .selectAll("myPoints")
                  .data(function (d) { return d.values })
                  .enter()
                  .append("circle")
                  .attr("cx", function (d) { return x(d.time) })
                  .attr("cy", function (d) { return y(d.value) })
                  .attr("r", 5)
                  .attr("stroke", "white")

                // Add a label at the end of each line
                svg3
                  .selectAll("myLabels")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr("class", function (d) { return d.name })
                  .datum(function (d) { return { name: d.name, value: d.values[d.values.length - 1] }; }) // keep only the last value of each time series
                  .attr("transform", function (d) { return "translate(" + x(d.value.time) + "," + y(d.value.value) + ")"; }) // Put the text at the position of the last point
                  .attr("x", 12) // shift the text a bit more right
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                // .style("opacity", 0)

                // Add a legend (interactive)
                svg3
                  .selectAll("myLegend")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr('x', function (d, i) { return 30 + i * 120 })
                  .attr('y', 430)
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                  .on("click", function (d) {
                    // is the element currently visible ?
                    currentOpacity = d3.selectAll("." + d.name).style("opacity")
                    // Change the opacity: from 0 to 1 or from 1 to 0
                    d3.selectAll("." + d.name).transition().style("opacity", currentOpacity == 1 ? 0 : 1)

                  })
              })
              var myimage = svg3.append('image')
                .attr('xlink:href', '../img/GB.png')
                .attr('width', 70)
              // .attr("style", "outline: thin solid black;") 

              myimage.attr('x', 40)

            </script>
          </div>

          <div class="container-child">
            <div id="my_dataviz4"></div>
            <script>

              // set the dimensions and margins of the graph
              var margin = { top: 10, right: 100, bottom: 30, left: 100 },
                width = 610 - margin.left - margin.right,
                height = 400 - margin.top - margin.bottom;

              // append the svg object to the body of the page
              var svg4 = d3.select("#my_dataviz4")
                .append("svg")
                .attr("width", width + margin.left + margin.right + 100)
                .attr("height", height + margin.top + margin.bottom + 100)
                .append("g")
                .attr("transform",
                  "translate(" + margin.left + "," + margin.bottom + ")");

              //Read the data
              d3.csv("./data/FR_connected_scatter.csv", function (data) {

                // List of groups (here I have one group per column)
                var allGroup = ["France_2019", "France_2020"]

                // Reformat the data: we need an array of arrays of {x, y} tuples
                var dataReady = allGroup.map(function (grpName) { // .map allows to do something for each element of the list
                  return {
                    name: grpName,
                    values: data.map(function (d) {
                      return { time: d.time, value: +d[grpName] };
                    })
                  };
                });
                // I strongly advise to have a look to dataReady with
                console.log(dataReady)

                // A color scale: one color for each group
                var myColor = d3.scaleOrdinal()
                  .domain(allGroup)
                  .range(d3.schemeCategory10);

                // Add X axis --> it is a date format
                var tickLabels = ['0', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                var x = d3.scaleLinear()
                  .domain([0, 12])
                  .range([0, width])
                svg4.append("g")
                  .attr("transform", "translate(0," + height + ")")
                  .style("font-size", "15px")
                  .call(d3.axisBottom(x).tickFormat(function (d, i) { return tickLabels[i] }));

                // Add Y axis
                var y = d3.scaleLinear()
                  .domain([8000, 130000])
                  .range([height, 0]);
                svg4.append("g")
                  .style("font-size", "15px")
                  .call(d3.axisLeft(y));

                // Add the lines
                var line = d3.line()
                  .x(function (d) { return x(+d.time) })
                  .y(function (d) { return y(+d.value) })
                svg4.selectAll("myLines")
                  .data(dataReady)
                  .enter()
                  .append("path")
                  .attr("class", function (d) { return d.name })
                  .attr("d", function (d) { return line(d.values) })
                  .attr("stroke", function (d) { return myColor(d.name) })
                  .style("stroke-width", 4)
                  .style("fill", "none")
                // .style("opacity", 0)

                // Add the points
                svg4
                  // First we need to enter in a group
                  .selectAll("myDots")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .style("fill", function (d) { return myColor(d.name) })
                  .attr("class", function (d) { return d.name })
                  // .style("opacity", 0)
                  // Second we need to enter in the 'values' part of this group
                  .selectAll("myPoints")
                  .data(function (d) { return d.values })
                  .enter()
                  .append("circle")
                  .attr("cx", function (d) { return x(d.time) })
                  .attr("cy", function (d) { return y(d.value) })
                  .attr("r", 5)
                  .attr("stroke", "white")

                // Add a label at the end of each line
                svg4
                  .selectAll("myLabels")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr("class", function (d) { return d.name })
                  .datum(function (d) { return { name: d.name, value: d.values[d.values.length - 1] }; }) // keep only the last value of each time series
                  .attr("transform", function (d) { return "translate(" + x(d.value.time) + "," + y(d.value.value) + ")"; }) // Put the text at the position of the last point
                  .attr("x", 12) // shift the text a bit more right
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                // .style("opacity", 0)

                // Add a legend (interactive)
                svg4
                  .selectAll("myLegend")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr('x', function (d, i) { return 30 + i * 160 })
                  .attr('y', 430)
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                  .on("click", function (d) {
                    // is the element currently visible ?
                    currentOpacity = d3.selectAll("." + d.name).style("opacity")
                    // Change the opacity: from 0 to 1 or from 1 to 0
                    d3.selectAll("." + d.name).transition().style("opacity", currentOpacity == 1 ? 0 : 1)

                  })
              })
              var myimage = svg4.append('image')
                .attr('xlink:href', '../img/FR.png')
                .attr('width', 70)
                .attr("style", "outline: thin solid black;")

              myimage.attr('x', 40)

            </script>
          </div>

          <div class="container-child">
            <div id="my_dataviz5"></div>
            <script>

              // set the dimensions and margins of the graph
              var margin = { top: 10, right: 100, bottom: 30, left: 100 },
                width = 610 - margin.left - margin.right,
                height = 400 - margin.top - margin.bottom;

              // append the svg object to the body of the page
              var svg5 = d3.select("#my_dataviz5")
                .append("svg")
                .attr("width", width + margin.left + margin.right + 100)
                .attr("height", height + margin.top + margin.bottom + 100)
                .append("g")
                .attr("transform",
                  "translate(" + margin.left + "," + margin.bottom + ")");

              //Read the data
              d3.csv("./data/MY_connected_scatter.csv", function (data) {

                // List of groups (here I have one group per column)
                var allGroup = ["Malaysia_2019", "Malaysia_2020"]

                // Reformat the data: we need an array of arrays of {x, y} tuples
                var dataReady = allGroup.map(function (grpName) { // .map allows to do something for each element of the list
                  return {
                    name: grpName,
                    values: data.map(function (d) {
                      return { time: d.time, value: +d[grpName] };
                    })
                  };
                });
                // I strongly advise to have a look to dataReady with
                console.log(dataReady)

                // A color scale: one color for each group
                var myColor = d3.scaleOrdinal()
                  .domain(allGroup)
                  .range(d3.schemeCategory10);

                // Add X axis --> it is a date format
                var tickLabels = ['0', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                var x = d3.scaleLinear()
                  .domain([0, 12])
                  .range([0, width])
                svg5.append("g")
                  .attr("transform", "translate(0," + height + ")")
                  .style("font-size", "15px")
                  .call(d3.axisBottom(x).tickFormat(function (d, i) { return tickLabels[i] }));

                // Add Y axis
                var y = d3.scaleLinear()
                  .domain([200, 55000])
                  .range([height, 0]);
                svg5.append("g")
                  .style("font-size", "15px")
                  .call(d3.axisLeft(y));

                // Add the lines
                var line = d3.line()
                  .x(function (d) { return x(+d.time) })
                  .y(function (d) { return y(+d.value) })
                svg5.selectAll("myLines")
                  .data(dataReady)
                  .enter()
                  .append("path")
                  .attr("class", function (d) { return d.name })
                  .attr("d", function (d) { return line(d.values) })
                  .attr("stroke", function (d) { return myColor(d.name) })
                  .style("stroke-width", 4)
                  .style("fill", "none")
                // .style("opacity", 0)

                // Add the points
                svg5
                  // First we need to enter in a group
                  .selectAll("myDots")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .style("fill", function (d) { return myColor(d.name) })
                  .attr("class", function (d) { return d.name })
                  // .style("opacity", 0)
                  // Second we need to enter in the 'values' part of this group
                  .selectAll("myPoints")
                  .data(function (d) { return d.values })
                  .enter()
                  .append("circle")
                  .attr("cx", function (d) { return x(d.time) })
                  .attr("cy", function (d) { return y(d.value) })
                  .attr("r", 5)
                  .attr("stroke", "white")

                // Add a label at the end of each line
                svg5
                  .selectAll("myLabels")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr("class", function (d) { return d.name })
                  .datum(function (d) { return { name: d.name, value: d.values[d.values.length - 1] }; }) // keep only the last value of each time series
                  .attr("transform", function (d) { return "translate(" + x(d.value.time) + "," + y(d.value.value) + ")"; }) // Put the text at the position of the last point
                  .attr("x", 12) // shift the text a bit more right
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                // .style("opacity", 0)

                // Add a legend (interactive)
                svg5
                  .selectAll("myLegend")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr('x', function (d, i) { return 30 + i * 180 })
                  .attr('y', 430)
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                  .on("click", function (d) {
                    // is the element currently visible ?
                    currentOpacity = d3.selectAll("." + d.name).style("opacity")
                    // Change the opacity: from 0 to 1 or from 1 to 0
                    d3.selectAll("." + d.name).transition().style("opacity", currentOpacity == 1 ? 0 : 1)

                  })
              })

              var myimage = svg5.append('image')
                .attr('xlink:href', '../img/MY.png')
                .attr('width', 70)

              myimage.attr('x', 40) 
            </script>
          </div>

          <div class="container-child">
            <div id="my_dataviz6"></div>
            <script>

              // set the dimensions and margins of the graph
              var margin = { top: 10, right: 100, bottom: 30, left: 100 },
                width = 610 - margin.left - margin.right,
                height = 400 - margin.top - margin.bottom;

              // append the svg object to the body of the page
              var svg6 = d3.select("#my_dataviz6")
                .append("svg")
                .attr("width", width + margin.left + margin.right + 100)
                .attr("height", height + margin.top + margin.bottom + 100)
                .append("g")
                .attr("transform",
                  "translate(" + margin.left + "," + margin.bottom + ")");

              //Read the data
              d3.csv("./data/PH_connected_scatter.csv", function (data) {

                // List of groups (here I have one group per column)
                var allGroup = ["Philippines_2019", "Philippines_2020"]

                // Reformat the data: we need an array of arrays of {x, y} tuples
                var dataReady = allGroup.map(function (grpName) { // .map allows to do something for each element of the list
                  return {
                    name: grpName,
                    values: data.map(function (d) {
                      return { time: d.time, value: +d[grpName] };
                    })
                  };
                });
                // I strongly advise to have a look to dataReady with
                console.log(dataReady)

                // A color scale: one color for each group
                var myColor = d3.scaleOrdinal()
                  .domain(allGroup)
                  .range(d3.schemeCategory10);

                // Add X axis --> it is a date format
                var tickLabels = ['0', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                var x = d3.scaleLinear()
                  .domain([0, 12])
                  .range([0, width])
                svg6.append("g")
                  .attr("transform", "translate(0," + height + ")")
                  .style("font-size", "15px")
                  .call(d3.axisBottom(x).tickFormat(function (d, i) { return tickLabels[i] }));

                // Add Y axis
                var y = d3.scaleLinear()
                  .domain([200, 30000])
                  .range([height, 0]);
                svg6.append("g")
                  .style("font-size", "15px")
                  .call(d3.axisLeft(y));

                // Add the lines
                var line = d3.line()
                  .x(function (d) { return x(+d.time) })
                  .y(function (d) { return y(+d.value) })
                svg6.selectAll("myLines")
                  .data(dataReady)
                  .enter()
                  .append("path")
                  .attr("class", function (d) { return d.name })
                  .attr("d", function (d) { return line(d.values) })
                  .attr("stroke", function (d) { return myColor(d.name) })
                  .style("stroke-width", 4)
                  .style("fill", "none")
                // .style("opacity", 0)

                // Add the points
                svg6
                  // First we need to enter in a group
                  .selectAll("myDots")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .style("fill", function (d) { return myColor(d.name) })
                  .attr("class", function (d) { return d.name })
                  // .style("opacity", 0)
                  // Second we need to enter in the 'values' part of this group
                  .selectAll("myPoints")
                  .data(function (d) { return d.values })
                  .enter()
                  .append("circle")
                  .attr("cx", function (d) { return x(d.time) })
                  .attr("cy", function (d) { return y(d.value) })
                  .attr("r", 5)
                  .attr("stroke", "white")

                // Add a label at the end of each line
                svg6
                  .selectAll("myLabels")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr("class", function (d) { return d.name })
                  .datum(function (d) { return { name: d.name, value: d.values[d.values.length - 1] }; }) // keep only the last value of each time series
                  .attr("transform", function (d) { return "translate(" + x(d.value.time) + "," + y(d.value.value) + ")"; }) // Put the text at the position of the last point
                  .attr("x", 12) // shift the text a bit more right
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                // .style("opacity", 0)

                // Add a legend (interactive)
                svg6
                  .selectAll("myLegend")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr('x', function (d, i) { return 30 + i * 200 })
                  .attr('y', 430)
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                  .on("click", function (d) {
                    // is the element currently visible ?
                    currentOpacity = d3.selectAll("." + d.name).style("opacity")
                    // Change the opacity: from 0 to 1 or from 1 to 0
                    d3.selectAll("." + d.name).transition().style("opacity", currentOpacity == 1 ? 0 : 1)

                  })
              })
              var myimage = svg6.append('image')
                .attr('xlink:href', '../img/PH.png')
                .attr('width', 70)
                .attr("style", "outline: thin solid black;")

              myimage.attr('x', 40)
            </script>
          </div>

          <div class="container-child">
            <div id="my_dataviz7"></div>
            <script>

              // set the dimensions and margins of the graph
              var margin = { top: 10, right: 100, bottom: 30, left: 100 },
                width = 610 - margin.left - margin.right,
                height = 400 - margin.top - margin.bottom;

              // append the svg object to the body of the page
              var svg7 = d3.select("#my_dataviz7")
                .append("svg")
                .attr("width", width + margin.left + margin.right + 100)
                .attr("height", height + margin.top + margin.bottom + 100)
                .append("g")
                .attr("transform",
                  "translate(" + margin.left + "," + margin.bottom + ")");

              //Read the data
              d3.csv("./data/RU_connected_scatter.csv", function (data) {

                // List of groups (here I have one group per column)
                var allGroup = ["Russia_2019", "Russia_2020"]

                // Reformat the data: we need an array of arrays of {x, y} tuples
                var dataReady = allGroup.map(function (grpName) { // .map allows to do something for each element of the list
                  return {
                    name: grpName,
                    values: data.map(function (d) {
                      return { time: d.time, value: +d[grpName] };
                    })
                  };
                });
                // I strongly advise to have a look to dataReady with
                console.log(dataReady)

                // A color scale: one color for each group
                var myColor = d3.scaleOrdinal()
                  .domain(allGroup)
                  .range(d3.schemeCategory10);

                // Add X axis --> it is a date format
                var tickLabels = ['0', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                var x = d3.scaleLinear()
                  .domain([0, 12])
                  .range([0, width])
                svg7.append("g")
                  .attr("transform", "translate(0," + height + ")")
                  .style("font-size", "15px")
                  .call(d3.axisBottom(x).tickFormat(function (d, i) { return tickLabels[i] }));

                // Add Y axis
                var y = d3.scaleLinear()
                  .domain([10000, 90000])
                  .range([height, 0]);
                svg7.append("g")
                  .style("font-size", "15px")
                  .call(d3.axisLeft(y));

                // Add the lines
                var line = d3.line()
                  .x(function (d) { return x(+d.time) })
                  .y(function (d) { return y(+d.value) })
                svg7.selectAll("myLines")
                  .data(dataReady)
                  .enter()
                  .append("path")
                  .attr("class", function (d) { return d.name })
                  .attr("d", function (d) { return line(d.values) })
                  .attr("stroke", function (d) { return myColor(d.name) })
                  .style("stroke-width", 4)
                  .style("fill", "none")
                // .style("opacity", 0)

                // Add the points
                svg7
                  // First we need to enter in a group
                  .selectAll("myDots")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .style("fill", function (d) { return myColor(d.name) })
                  .attr("class", function (d) { return d.name })
                  // .style("opacity", 0)
                  // Second we need to enter in the 'values' part of this group
                  .selectAll("myPoints")
                  .data(function (d) { return d.values })
                  .enter()
                  .append("circle")
                  .attr("cx", function (d) { return x(d.time) })
                  .attr("cy", function (d) { return y(d.value) })
                  .attr("r", 5)
                  .attr("stroke", "white")

                // Add a label at the end of each line
                svg7
                  .selectAll("myLabels")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr("class", function (d) { return d.name })
                  .datum(function (d) { return { name: d.name, value: d.values[d.values.length - 1] }; }) // keep only the last value of each time series
                  .attr("transform", function (d) { return "translate(" + x(d.value.time) + "," + y(d.value.value) + ")"; }) // Put the text at the position of the last point
                  .attr("x", 12) // shift the text a bit more right
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                // .style("opacity", 0)

                // Add a legend (interactive)
                svg7
                  .selectAll("myLegend")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr('x', function (d, i) { return 30 + i * 160 })
                  .attr('y', 430)
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                  .on("click", function (d) {
                    // is the element currently visible ?
                    currentOpacity = d3.selectAll("." + d.name).style("opacity")
                    // Change the opacity: from 0 to 1 or from 1 to 0
                    d3.selectAll("." + d.name).transition().style("opacity", currentOpacity == 1 ? 0 : 1)

                  })
              })
              var myimage = svg7.append('image')
                .attr('xlink:href', '../img/RU.png')
                .attr('width', 70)
                .attr("style", "outline: thin solid black;")

              myimage.attr('x', 40)

            </script>
          </div>

          <div class="container-child">
            <div id="my_dataviz8"></div>
            <script>

              // set the dimensions and margins of the graph
              var margin = { top: 10, right: 100, bottom: 30, left: 100 },
                width = 610 - margin.left - margin.right,
                height = 400 - margin.top - margin.bottom;

              // append the svg object to the body of the page
              var svg8 = d3.select("#my_dataviz8")
                .append("svg")
                .attr("width", width + margin.left + margin.right + 100)
                .attr("height", height + margin.top + margin.bottom + 100)
                .append("g")
                .attr("transform",
                  "translate(" + margin.left + "," + margin.bottom + ")");

              //Read the data
              d3.csv("./data/AU_connected_scatter.csv", function (data) {

                // List of groups (here I have one group per column)
                var allGroup = ["Australia_2019", "Australia_2020"]

                // Reformat the data: we need an array of arrays of {x, y} tuples
                var dataReady = allGroup.map(function (grpName) { // .map allows to do something for each element of the list
                  return {
                    name: grpName,
                    values: data.map(function (d) {
                      return { time: d.time, value: +d[grpName] };
                    })
                  };
                });
                // I strongly advise to have a look to dataReady with
                console.log(dataReady)

                // A color scale: one color for each group
                var myColor = d3.scaleOrdinal()
                  .domain(allGroup)
                  .range(d3.schemeCategory10);

                // Add X axis --> it is a date format
                var tickLabels = ['0', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                var x = d3.scaleLinear()
                  .domain([0, 12])
                  .range([0, width])
                svg8.append("g")
                  .attr("transform", "translate(0," + height + ")")
                  .style("font-size", "15px")
                  .call(d3.axisBottom(x).tickFormat(function (d, i) { return tickLabels[i] }));

                // Add Y axis
                var y = d3.scaleLinear()
                  .domain([50000, 170000])
                  .range([height, 0]);
                svg8.append("g")
                  .style("font-size", "15px")
                  .call(d3.axisLeft(y));

                // Add the lines
                var line = d3.line()
                  .x(function (d) { return x(+d.time) })
                  .y(function (d) { return y(+d.value) })
                svg8.selectAll("myLines")
                  .data(dataReady)
                  .enter()
                  .append("path")
                  .attr("class", function (d) { return d.name })
                  .attr("d", function (d) { return line(d.values) })
                  .attr("stroke", function (d) { return myColor(d.name) })
                  .style("stroke-width", 4)
                  .style("fill", "none")
                // .style("opacity", 0)

                // Add the points
                svg8
                  // First we need to enter in a group
                  .selectAll("myDots")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .style("fill", function (d) { return myColor(d.name) })
                  .attr("class", function (d) { return d.name })
                  // .style("opacity", 0)
                  // Second we need to enter in the 'values' part of this group
                  .selectAll("myPoints")
                  .data(function (d) { return d.values })
                  .enter()
                  .append("circle")
                  .attr("cx", function (d) { return x(d.time) })
                  .attr("cy", function (d) { return y(d.value) })
                  .attr("r", 5)
                  .attr("stroke", "white")

                // Add a label at the end of each line
                svg8
                  .selectAll("myLabels")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr("class", function (d) { return d.name })
                  .datum(function (d) { return { name: d.name, value: d.values[d.values.length - 1] }; }) // keep only the last value of each time series
                  .attr("transform", function (d) { return "translate(" + x(d.value.time) + "," + y(d.value.value) + ")"; }) // Put the text at the position of the last point
                  .attr("x", 12) // shift the text a bit more right
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                // .style("opacity", 0)

                // Add a legend (interactive)
                svg8
                  .selectAll("myLegend")
                  .data(dataReady)
                  .enter()
                  .append('g')
                  .append("text")
                  .attr('x', function (d, i) { return 30 + i * 180 })
                  .attr('y', 430)
                  .text(function (d) { return d.name; })
                  .style("fill", function (d) { return myColor(d.name) })
                  .style("font-size", 20)
                  .style("font-weight", "bold")
                  .on("click", function (d) {
                    // is the element currently visible ?
                    currentOpacity = d3.selectAll("." + d.name).style("opacity")
                    // Change the opacity: from 0 to 1 or from 1 to 0
                    d3.selectAll("." + d.name).transition().style("opacity", currentOpacity == 1 ? 0 : 1)

                  })
              })
              var myimage = svg8.append('image')
                .attr('xlink:href', '../img/AU.png')
                .attr('width', 70)

              myimage.attr('x', 40)

            </script>
          </div>
        </div>

      </main>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  <script src="js/scripts.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>

</body>

</html>